"use strict";console.log("Base URL:",base_url),$(document).ready(function(){var l={},r={},a=new Audio(base_url+"assets/audio/alert_sound.mp3");function u(a){$("#alert-message").text(a),$("#alert-overlay").fadeIn()}function f(){try{a.currentTime=0,a.play().then(function(){console.log("El sonido se está reproduciendo.")}).catch(function(a){console.log("Error al reproducir el audio:",a)})}catch(a){console.log("Error al intentar reproducir el sonido:",a)}}function o(){$(".card").each(function(){var a=$(this),i=a.data("id");if(l[i]){var n=new Date,e=l[i],r=Math.floor((n-e)/1e3),o=Math.floor(r/3600),t=Math.floor(r%3600/60),s=r%60,c=o.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0");a.find(".contador").text(c);var d=parseInt(a.find(".parar-a").val());d&&d<=t&&(p(i,a),u("El tiempo ha terminado para la máquina "+a.find(".card-header h5").text()),f())}})}function p(i,n){$.post(base_url+"index.php/Ciber/finalizar_sesion",{id:i},function(a){a.success?(n.find(".status-indicator").removeClass("status-active").addClass("status-inactive"),n.find(".estado").text("sin usar"),n.find(".inicio").text(""),n.find(".contador").text("00:00:00"),n.find(".nota").val(""),clearInterval(r[i]),delete l[i],delete r[i],n.find(".iniciar").prop("disabled",!1),n.find(".finalizar").prop("disabled",!0)):u("Error al finalizar sesión.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}function i(a){confirm("¿Está seguro de que desea eliminar esta máquina?")&&(f(),$.post(base_url+"index.php/Ciber/eliminar_maquina",{id:a},function(a){console.log("Respuesta del servidor:",a),a.success?(u("Máquina eliminada correctamente."),setTimeout(function(){location.reload()},1e3)):u("Error al eliminar la máquina.")},"json").fail(function(){u("Error de comunicación con el servidor.")}))}a.addEventListener("canplaythrough",function(){console.log("El sonido se cargó correctamente.")}),a.addEventListener("error",function(a){console.log("Error al cargar el sonido:",a)}),console.log("Ruta del sonido:",base_url+"assets/audio/alert_sound.mp3"),$("body").append('<button id="prueba-sonido" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">Probar Sonido</button>'),$("#prueba-sonido").click(function(){f()}),$("#alert-close").click(function(){$("#alert-overlay").fadeOut()}),$(".eliminar").click(function(){i($(this).closest(".card").data("id"))}),$("#eliminar-maquina-btn").click(function(){var a=$("#maquina-a-eliminar").val();a?i(a):u("Por favor, seleccione una máquina para eliminar.")}),$(".iniciar").click(function(){var a=$(this).closest(".card");!function(i,n){var e=new Date,a=n.find(".parar-a").val();$.post(base_url+"index.php/Ciber/iniciar_sesion",{id:i,parar_a:a},function(a){a.success?(n.find(".status-indicator").removeClass("status-inactive").addClass("status-active"),n.find(".estado").text("en uso"),n.find(".inicio").text(e.toLocaleTimeString()),l[i]=e,n.find(".contador").text("00:00:00"),r[i]=setInterval(function(){o()},1e3),n.find(".iniciar").prop("disabled",!0),n.find(".finalizar").prop("disabled",!1)):u("Error al iniciar sesión.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}(a.data("id"),a)}),$(".finalizar").click(function(){var a=$(this).closest(".card");p(a.data("id"),a)}),$(".enviar-mensaje").click(function(){var i=$(this).closest(".card"),a=i.data("id"),n=i.find(".nota").val(),e=i.find(".mensaje").val();$.post(base_url+"index.php/Ciber/actualizar_nota_mensaje",{id:a,nota:n,mensaje:e},function(a){a.success?(u("Mensaje enviado correctamente."),i.find(".mensaje").val("")):u("Error al actualizar nota y mensaje.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}),$("#agregar-maquina-form").submit(function(a){a.preventDefault();var i=$("#nombre-maquina").val();$.post(base_url+"index.php/Ciber/agregar_maquina",{nombre:i},function(a){a.success?(u("Máquina agregada correctamente."),location.reload()):u("Error al agregar la máquina.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}),$(".card").each(function(){var a=$(this);if("en uso"===a.find(".estado").text().trim()){a.find(".iniciar").prop("disabled",!0),a.find(".finalizar").prop("disabled",!1);var i=new Date(a.find(".inicio").text());l[id]=i,r[id]=setInterval(function(){o()},1e3)}else a.find(".iniciar").prop("disabled",!1),a.find(".finalizar").prop("disabled",!0)}),o(),setInterval(o,1e3)});
//# sourceMappingURL=ciber.min.js.map
