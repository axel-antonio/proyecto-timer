"use strict";console.log("Base URL:",base_url),$(document).ready(function(){var l={},t={},a=new Audio(base_url+"assets/audio/alert_sound.mp3");function u(a){$("#alert-message").text(a),$("#alert-overlay").fadeIn()}function f(){try{a.currentTime=0,a.play().then(function(){console.log("El sonido se está reproduciendo.")}).catch(function(a){console.log("Error al reproducir el audio:",a)})}catch(a){console.log("Error al intentar reproducir el sonido:",a)}}function o(){$(".card").each(function(){var a=$(this),n=a.data("id");if(l[n]){var e=new Date,i=l[n],t=Math.floor((e-i)/1e3),o=Math.floor(t/3600),r=Math.floor(t%3600/60),s=t%60,c=o.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0");a.find(".contador").text(c);var d=parseInt(a.find(".parar-a").val());d&&d<=r&&(m(n,a),u("El tiempo ha terminado para la máquina "+a.find(".card-header h5").text()),f())}})}function m(n,e){$.post(base_url+"index.php/Ciber/finalizar_sesion",{id:n},function(a){a.success?(e.find(".status-indicator").removeClass("status-active").addClass("status-inactive"),e.find(".estado").text("sin usar"),e.find(".inicio").text(""),e.find(".contador").text("00:00:00"),e.find(".nota").val(""),clearInterval(t[n]),delete l[n],delete t[n],e.find(".iniciar").prop("disabled",!1),e.find(".finalizar").prop("disabled",!0)):u("Error al finalizar sesión.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}function n(a){confirm("¿Está seguro de que desea eliminar esta máquina?")&&(f(),$.post(base_url+"index.php/Ciber/eliminar_maquina",{id:a},function(a){console.log("Respuesta del servidor:",a),a.success?(u("Máquina eliminada correctamente."),setTimeout(function(){location.reload()},1e3)):u("Error al eliminar la máquina.")},"json").fail(function(){u("Error de comunicación con el servidor.")}))}function e(){var a=new Date,n=document.getElementById("clock"),e=document.getElementById("date");n&&e&&(n.textContent=a.toLocaleTimeString(),e.textContent=a.toLocaleDateString())}a.addEventListener("canplaythrough",function(){console.log("El sonido se cargó correctamente.")}),a.addEventListener("error",function(a){console.log("Error al cargar el sonido:",a)}),console.log("Ruta del sonido:",base_url+"assets/audio/alert_sound.mp3"),$("body").append('<button id="prueba-sonido" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000;">Probar Sonido</button>'),$("#prueba-sonido").click(function(){f()}),$("#alert-close").click(function(){$("#alert-overlay").fadeOut()}),$(".eliminar").click(function(){n($(this).closest(".card").data("id"))}),$("#eliminar-maquina-btn").click(function(){var a=$("#maquina-a-eliminar").val();a?n(a):u("Por favor, seleccione una máquina para eliminar.")}),$(".iniciar").click(function(){var a=$(this).closest(".card");!function(n,e){var i=new Date,a=e.find(".parar-a").val();$.post(base_url+"index.php/Ciber/iniciar_sesion",{id:n,parar_a:a},function(a){a.success?(e.find(".status-indicator").removeClass("status-inactive").addClass("status-active"),e.find(".estado").text("en uso"),e.find(".inicio").text(i.toLocaleTimeString()),l[n]=i,e.find(".contador").text("00:00:00"),t[n]=setInterval(function(){o()},1e3),e.find(".iniciar").prop("disabled",!0),e.find(".finalizar").prop("disabled",!1)):u("Error al iniciar sesión.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}(a.data("id"),a)}),$(".finalizar").click(function(){var a=$(this).closest(".card");m(a.data("id"),a)}),$(".enviar-mensaje").click(function(){var n=$(this).closest(".card"),a=n.data("id"),e=n.find(".nota").val(),i=n.find(".mensaje").val();$.post(base_url+"index.php/Ciber/actualizar_nota_mensaje",{id:a,nota:e,mensaje:i},function(a){a.success?(u("Mensaje enviado correctamente."),n.find(".mensaje").val("")):u("Error al actualizar nota y mensaje.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}),$("#agregar-maquina-form").submit(function(a){a.preventDefault();var n=$("#nombre-maquina").val();$.post(base_url+"index.php/Ciber/agregar_maquina",{nombre:n},function(a){a.success?(u("Máquina agregada correctamente."),location.reload()):u("Error al agregar la máquina.")},"json").fail(function(){u("Error de comunicación con el servidor.")})}),$(".card").each(function(){var a=$(this);if("en uso"===a.find(".estado").text().trim()){a.find(".iniciar").prop("disabled",!0),a.find(".finalizar").prop("disabled",!1);var n=new Date(a.find(".inicio").text()),e=a.data("id");l[e]=n,t[e]=setInterval(function(){o()},1e3),setInterval(function(){$(".card-header h5").each(function(){var a=this;$(this).css("transform","scale(1.05)"),setTimeout(function(){$(a).css("transform","scale(1)")},500)})},5e3)}else a.find(".iniciar").prop("disabled",!1),a.find(".finalizar").prop("disabled",!0)}),setInterval(e,1e3),e(),setInterval(function(){var a=document.getElementById("controlador-title");a&&(a.style.transform="scale(1.05)",setTimeout(function(){a.style.transform="scale(1)"},500))},5e3),o(),setInterval(o,1e3)});
//# sourceMappingURL=ciber.min.js.map
