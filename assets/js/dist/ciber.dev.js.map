{"version":3,"sources":["ciber.js"],"names":["console","log","base_url","$","document","ready","sessionStartTimes","sessionTimers","alertSound","Audio","addEventListener","e","showAlert","message","text","fadeIn","playAlertSound","currentTime","play","then","error","append","click","fadeOut","actualizarContadores","each","card","id","data","ahora","Date","inicio","diferencia","Math","floor","horas","minutos","segundos","tiempoTranscurrido","toString","padStart","find","pararA","parseInt","val","finalizarSesion","iniciarSesion","post","parar_a","response","success","removeClass","addClass","toLocaleTimeString","setInterval","prop","fail","clearInterval","eliminarMaquina","confirm","setTimeout","location","reload","closest","maquinaId","nota","mensaje","submit","preventDefault","nombre","trim"],"mappings":"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","sourcesContent":["console.log('Base URL:', base_url);\r\n\r\n$(document).ready(function() {\r\n    var sessionStartTimes = {};\r\n    var sessionTimers = {};\r\n    var alertSound = new Audio(base_url + 'assets/audio/alert_sound.mp3');\r\n\r\n    // Verificar si el audio se carga correctamente\r\n    alertSound.addEventListener('canplaythrough', function() {\r\n        console.log('El sonido se cargó correctamente.');\r\n    });\r\n\r\n    alertSound.addEventListener('error', function(e) {\r\n        console.log('Error al cargar el sonido:', e);\r\n    });\r\n\r\n    console.log('Ruta del sonido:', base_url + 'assets/audio/alert_sound.mp3');\r\n\r\n    function showAlert(message) {\r\n        $('#alert-message').text(message);\r\n        $('#alert-overlay').fadeIn();\r\n    }\r\n\r\n    function playAlertSound() {\r\n        try {\r\n            alertSound.currentTime = 0;\r\n            alertSound.play().then(() => {\r\n                console.log('El sonido se está reproduciendo.');\r\n            }).catch(function(error) {\r\n                console.log('Error al reproducir el audio:', error);\r\n            });\r\n        } catch (e) {\r\n            console.log('Error al intentar reproducir el sonido:', e);\r\n        }\r\n    }\r\n\r\n    // Botón de prueba para reproducir el sonido manualmente\r\n    $('body').append('<button id=\"prueba-sonido\" style=\"position: fixed; bottom: 20px; right: 20px; z-index: 1000;\">Probar Sonido</button>');\r\n    $('#prueba-sonido').click(function() {\r\n        playAlertSound();\r\n    });\r\n\r\n    $('#alert-close').click(function() {\r\n        $('#alert-overlay').fadeOut();\r\n    });\r\n\r\n    function actualizarContadores() {\r\n        $('.card').each(function() {\r\n            var card = $(this);\r\n            var id = card.data('id');\r\n\r\n            if (sessionStartTimes[id]) {\r\n                var ahora = new Date();\r\n                var inicio = sessionStartTimes[id];\r\n                var diferencia = Math.floor((ahora - inicio) / 1000);\r\n\r\n                var horas = Math.floor(diferencia / 3600);\r\n                var minutos = Math.floor((diferencia % 3600) / 60);\r\n                var segundos = diferencia % 60;\r\n\r\n                var tiempoTranscurrido = \r\n                    horas.toString().padStart(2, '0') + ':' +\r\n                    minutos.toString().padStart(2, '0') + ':' +\r\n                    segundos.toString().padStart(2, '0');\r\n\r\n                card.find('.contador').text(tiempoTranscurrido);\r\n\r\n                var pararA = parseInt(card.find('.parar-a').val());\r\n                if (pararA && (minutos >= pararA)) {\r\n                    finalizarSesion(id, card);\r\n                    showAlert('El tiempo ha terminado para la máquina ' + card.find('.card-header h5').text());\r\n                    playAlertSound(); // Sonar la alarma cuando el tiempo ha terminado\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    function iniciarSesion(id, card) {\r\n        var ahora = new Date();\r\n        var pararA = card.find('.parar-a').val();\r\n\r\n        $.post(base_url + 'index.php/Ciber/iniciar_sesion', {id: id, parar_a: pararA}, function(response) {\r\n            if (response.success) {\r\n                card.find('.status-indicator').removeClass('status-inactive').addClass('status-active');\r\n                card.find('.estado').text('en uso');\r\n                card.find('.inicio').text(ahora.toLocaleTimeString());\r\n                sessionStartTimes[id] = ahora;\r\n                card.find('.contador').text('00:00:00');\r\n                sessionTimers[id] = setInterval(function() { actualizarContadores(); }, 1000);\r\n                card.find('.iniciar').prop('disabled', true);\r\n                card.find('.finalizar').prop('disabled', false);\r\n            } else {\r\n                showAlert('Error al iniciar sesión.');\r\n            }\r\n        }, 'json').fail(function() {\r\n            showAlert('Error de comunicación con el servidor.');\r\n        });\r\n    }\r\n\r\n    function finalizarSesion(id, card) {\r\n        $.post(base_url + 'index.php/Ciber/finalizar_sesion', {id: id}, function(response) {\r\n            if (response.success) {\r\n                card.find('.status-indicator').removeClass('status-active').addClass('status-inactive');\r\n                card.find('.estado').text('sin usar');\r\n                card.find('.inicio').text('');\r\n                card.find('.contador').text('00:00:00');\r\n                card.find('.nota').val('');\r\n                clearInterval(sessionTimers[id]);\r\n                delete sessionStartTimes[id];\r\n                delete sessionTimers[id];\r\n                card.find('.iniciar').prop('disabled', false);\r\n                card.find('.finalizar').prop('disabled', true);\r\n            } else {\r\n                showAlert('Error al finalizar sesión.');\r\n            }\r\n        }, 'json').fail(function() {\r\n            showAlert('Error de comunicación con el servidor.');\r\n        });\r\n    }\r\n\r\n    // Función para eliminar una máquina\r\n    function eliminarMaquina(id) {\r\n        if (confirm('¿Está seguro de que desea eliminar esta máquina?')) {\r\n            playAlertSound(); // Sonar la alarma al confirmar la eliminación\r\n            $.post(base_url + 'index.php/Ciber/eliminar_maquina', {id: id}, function(response) {\r\n                console.log('Respuesta del servidor:', response); // Verificar la respuesta del servidor\r\n                if (response.success) {\r\n                    showAlert('Máquina eliminada correctamente.');\r\n                    setTimeout(function() { // Agregar un retraso antes de recargar la página\r\n                        location.reload();\r\n                    }, 1000); // Retraso de 1 segundo para permitir que la alarma se reproduzca\r\n                } else {\r\n                    showAlert('Error al eliminar la máquina.');\r\n                }\r\n            }, 'json').fail(function() {\r\n                showAlert('Error de comunicación con el servidor.');\r\n            });\r\n        }\r\n    }\r\n\r\n    // Evento para el botón \"Eliminar\" de cada tarjeta\r\n    $('.eliminar').click(function() {\r\n        var card = $(this).closest('.card');\r\n        var id = card.data('id');\r\n        eliminarMaquina(id);\r\n    });\r\n\r\n    // Nuevo código para eliminar máquina desde la barra lateral\r\n    $('#eliminar-maquina-btn').click(function() {\r\n        var maquinaId = $('#maquina-a-eliminar').val();\r\n    \r\n        if (!maquinaId) {\r\n            showAlert('Por favor, seleccione una máquina para eliminar.');\r\n            return;\r\n        }\r\n\r\n        eliminarMaquina(maquinaId);\r\n    });\r\n\r\n    $('.iniciar').click(function() {\r\n        var card = $(this).closest('.card');\r\n        var id = card.data('id');\r\n        iniciarSesion(id, card);\r\n    });\r\n\r\n    $('.finalizar').click(function() {\r\n        var card = $(this).closest('.card');\r\n        var id = card.data('id');\r\n        finalizarSesion(id, card);\r\n    });\r\n\r\n    $('.enviar-mensaje').click(function() {\r\n        var card = $(this).closest('.card');\r\n        var id = card.data('id');\r\n        var nota = card.find('.nota').val();\r\n        var mensaje = card.find('.mensaje').val();\r\n        \r\n        $.post(base_url + 'index.php/Ciber/actualizar_nota_mensaje', {id: id, nota: nota, mensaje: mensaje}, function(response) {\r\n            if (response.success) {\r\n                showAlert('Mensaje enviado correctamente.');\r\n                card.find('.mensaje').val('');\r\n            } else {\r\n                showAlert('Error al actualizar nota y mensaje.');\r\n            }\r\n        }, 'json').fail(function() {\r\n            showAlert('Error de comunicación con el servidor.');\r\n        });\r\n    });\r\n\r\n    $('#agregar-maquina-form').submit(function(e) {\r\n        e.preventDefault();\r\n        var nombre = $('#nombre-maquina').val();\r\n\r\n        $.post(base_url + 'index.php/Ciber/agregar_maquina', {nombre: nombre}, function(response) {\r\n            if (response.success) {\r\n                showAlert('Máquina agregada correctamente.');\r\n                location.reload();\r\n            } else {\r\n                showAlert('Error al agregar la máquina.');\r\n            }\r\n        }, 'json').fail(function() {\r\n            showAlert('Error de comunicación con el servidor.');\r\n        });\r\n    });\r\n\r\n    // Inicializar el estado de los botones\r\n    $('.card').each(function() {\r\n        var card = $(this);\r\n        if (card.find('.estado').text().trim() === 'en uso') {\r\n            card.find('.iniciar').prop('disabled', true);\r\n            card.find('.finalizar').prop('disabled', false);\r\n            var inicio = new Date(card.find('.inicio').text());\r\n            sessionStartTimes[id] = inicio;\r\n            sessionTimers[id] = setInterval(function() { actualizarContadores(); }, 1000);\r\n        } else {\r\n            card.find('.iniciar').prop('disabled', false);\r\n            card.find('.finalizar').prop('disabled', true);\r\n        }\r\n    });\r\n\r\n    // Iniciar los contadores para las sesiones en curso\r\n    actualizarContadores();\r\n    setInterval(actualizarContadores, 1000);\r\n});\r\n\r\n"],"file":"ciber.dev.js"}